# ğŸ’° Planner Financeiro Full-Stack com Streamlit e Supabase

Um planner financeiro completo desenvolvido como uma aplicaÃ§Ã£o de pÃ¡gina Ãºnica (SPA) utilizando Streamlit no frontend e Supabase como backend, banco de dados (PostgreSQL) e autenticaÃ§Ã£o de usuÃ¡rios.

A aplicaÃ§Ã£o permite que mÃºltiplos usuÃ¡rios gerenciem suas finanÃ§as pessoais, com seguranÃ§a garantida pelo Row Level Security (RLS) do Supabase â€” cada usuÃ¡rio acessa apenas seus prÃ³prios dados.

## ğŸš€ DemonstraÃ§Ã£o

ğŸ“¸ [Adicione aqui um screenshot ou GIF do seu dashboard]

> **Dica:** Grave a tela com [LICEcap](https://www.cockos.com/licecap/) ou [ScreenToGif](https://www.screentogif.com/) e arraste o `.gif` para este README no GitHub.

## âœ¨ Funcionalidades Principais

- ğŸ” **AutenticaÃ§Ã£o de UsuÃ¡rios**: Login e cadastro completos via Supabase Auth
- ğŸ§± **SeguranÃ§a (RLS)**: Cada usuÃ¡rio sÃ³ visualiza e manipula suas prÃ³prias transaÃ§Ãµes
- ğŸ“Š **Dashboard de PÃ¡gina Ãšnica**: Toda a navegaÃ§Ã£o (login, dashboard e grÃ¡ficos) ocorre em uma Ãºnica pÃ¡gina
- ğŸ’¡ **KPIs Totais**: Exibe receita, despesa, saldo e investimentos acumulados
- ğŸ“… **KPIs Mensais**: Resumo filtrado por mÃªs e ano selecionados
- ğŸ“ˆ **GrÃ¡fico de TendÃªncia HistÃ³rica**: Mostra o fluxo de caixa (receitas, despesas e investimentos) e o saldo acumulado ao longo do tempo
- ğŸ¥§ **GrÃ¡ficos de Pizza**:
  - **Despesas do MÃªs**: DistribuiÃ§Ã£o de gastos do mÃªs filtrado
  - **Investimentos (Geral)**: DistribuiÃ§Ã£o total dos investimentos (sem filtro)
- ğŸ§¾ **CRUD de TransaÃ§Ãµes**: FormulÃ¡rio expansÃ­vel para adicionar, editar e excluir receitas, despesas e investimentos
- ğŸ“‹ **HistÃ³rico Mensal**: Tabela interativa com todas as transaÃ§Ãµes do mÃªs selecionado

## ğŸ› ï¸ Stack TecnolÃ³gica

| Camada | Tecnologia |
|--------|------------|
| Frontend | Streamlit |
| Backend & Banco de Dados | Supabase (PostgreSQL) |
| AutenticaÃ§Ã£o | Supabase Auth |
| AnÃ¡lise de Dados | Pandas |
| VisualizaÃ§Ã£o de Dados | Plotly |
| Gerenciamento de DependÃªncias | Poetry |

## âš™ï¸ InstalaÃ§Ã£o e Setup

Siga os passos abaixo para rodar o projeto localmente:

### 1. PrÃ©-requisitos

- Python 3.10+
- Poetry (para gerenciar dependÃªncias)
- Conta gratuita no Supabase

### 2. Clonar o RepositÃ³rio

```bash
git clone git@github.com:Pacodeoliv/template-financeiro.git
cd template-financeiro
```

### 3. Instalar DependÃªncias

```bash
poetry install
```

### 4. Configurar o Supabase

1. **Crie um novo projeto no Supabase**

2. **Desative a confirmaÃ§Ã£o de e-mail (modo dev)**:
   - VÃ¡ em `Authentication` â†’ `Providers` â†’ `Email`
   - Desmarque "Confirm email"

3. **Crie a tabela `transactions`**:
   - VÃ¡ em `SQL Editor` â†’ `New query`
   - Cole e execute o script abaixo:

```sql
-- 1. CRIAR A TABELA 'transactions'
CREATE TABLE transactions (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  tipo TEXT NOT NULL, -- 'receita', 'despesa' ou 'investimento'
  valor DECIMAL(10, 2) NOT NULL,
  descricao TEXT NOT NULL,
  categoria TEXT,
  data DATE NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2. HABILITAR ROW LEVEL SECURITY (RLS)
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;

-- 3. CRIAR POLÃTICAS DE ACESSO (Multi-usuÃ¡rio)
CREATE POLICY "Enable read access for own users"
ON transactions FOR SELECT
USING (auth.uid() = user_id);

CREATE POLICY "Enable insert access for own users"
ON transactions FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Enable update access for own users"
ON transactions FOR UPDATE
USING (auth.uid() = user_id)
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Enable delete access for own users"
ON transactions FOR DELETE
USING (auth.uid() = user_id);
```

### 5. Configurar VariÃ¡veis de Ambiente

1. No painel do Supabase, acesse:
   - `Project Settings` â†’ `API`
   - Copie:
     - **Project URL**
     - **Anon public key**

2. Crie o arquivo `.streamlit/secrets.toml` e adicione:

```toml
# .streamlit/secrets.toml
SUPABASE_URL = "SUA_URL_DO_PROJETO_SUPABASE"
SUPABASE_KEY = "SUA_CHAVE_ANON_PUBLICA"
```

> **âš ï¸ Importante**: O arquivo `secrets.toml` jÃ¡ estÃ¡ no `.gitignore` e nÃ£o serÃ¡ commitado. Nunca compartilhe suas chaves de API publicamente!

### 6. Executar o Aplicativo

```bash
# Ativar o ambiente virtual
poetry shell

# Rodar o Streamlit
streamlit run app.py
```

Ou, se preferir sem ativar o shell:

```bash
poetry run streamlit run app.py
```

### 7. Modo de Desenvolvimento (Opcional)

Para pular o login durante o desenvolvimento local, edite o arquivo `app.py` e configure:

```python
DEV_MODE = True
FAKE_USER_ID = "SEU_UID_DO_SUPABASE"  # UID do usuÃ¡rio de teste
FAKE_USER_EMAIL = "test@test.com"     # Email do usuÃ¡rio de teste
```

> **âš ï¸ Lembre-se**: Defina `DEV_MODE = False` antes de fazer deploy em produÃ§Ã£o!

## ğŸ“ Estrutura do Projeto

```
template-financeiro/
â”œâ”€â”€ .streamlit/
â”‚   â””â”€â”€ secrets.toml        # Chaves de API (NÃƒO ENVIAR PARA O GIT)
â”œâ”€â”€ app.py                  # AplicaÃ§Ã£o principal (UI, lÃ³gica e grÃ¡ficos)
â”œâ”€â”€ supabase_client.py      # FunÃ§Ãµes helper (Auth, CRUD)
â”œâ”€â”€ style.css               # Estilos customizados
â”œâ”€â”€ pyproject.toml          # DependÃªncias (Poetry)
â”œâ”€â”€ poetry.lock             # Lock file do Poetry
â”œâ”€â”€ requirements.txt        # DependÃªncias alternativas (pip)
â”œâ”€â”€ .gitignore              # Arquivos ignorados pelo Git
â””â”€â”€ README.md               # DocumentaÃ§Ã£o do projeto
```

## â˜ï¸ Deploy no Streamlit Cloud

1. **Envie o projeto para um repositÃ³rio no GitHub**
   - Certifique-se de que `.streamlit/` estÃ¡ no `.gitignore`
   - FaÃ§a push do cÃ³digo

2. **Acesse [share.streamlit.io](https://share.streamlit.io/)**

3. **Clique em "New app"** e selecione seu repositÃ³rio

4. **Configure as secrets**:
   - Em `Advanced settings...`
   - Adicione as seguintes secrets:
     - `SUPABASE_URL`: Sua URL do projeto Supabase
     - `SUPABASE_KEY`: Sua chave anon pÃºblica do Supabase

5. **Clique em "Deploy!"** ğŸš€

## ğŸ”’ SeguranÃ§a

- âœ… Row Level Security (RLS) habilitado no Supabase
- âœ… AutenticaÃ§Ã£o via Supabase Auth
- âœ… Chaves de API nÃ£o commitadas no repositÃ³rio
- âœ… Cada usuÃ¡rio acessa apenas seus prÃ³prios dados

## ğŸ“ Notas Importantes

- O arquivo `.streamlit/secrets.toml` nunca deve ser commitado
- Certifique-se de que o RLS estÃ¡ habilitado antes de fazer deploy
- Altere as credenciais se o arquivo `secrets.toml` foi exposto acidentalmente
- Em produÃ§Ã£o, mantenha `DEV_MODE = False` no cÃ³digo

## ğŸ¤ Contribuindo

ContribuiÃ§Ãµes sÃ£o bem-vindas! Sinta-se Ã  vontade para abrir issues ou pull requests.

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob licenÃ§a MIT.

## ğŸ‘¤ Autor

**Paco de Oliveira Saavedra**
- GitHub: [@Pacodeoliv](https://github.com/Pacodeoliv)

---

â­ Se este projeto foi Ãºtil para vocÃª, considere dar uma estrela no repositÃ³rio!
